# 포인터와 동적 객체 생성



## 포인터

- **포인터(pointer)**

    - 메모리의 주소값을 저장하는 변수
    - 변수 선언시 타입 뒤에 *를 지정
    - int *p; // 정수를 가리키는 포인터 선언

    ![image-20200908151322312](07.포인터와_동적_객체_생성.assets/image-20200908151322312.png)



- **주소 연산자 &**

    - 기존 변수의 주소 값을 획득하여 포인터 변수에 저장할 때 사용
    - int number = 10;
        int *p; // 정수를 가리키는 포인터 선언
        p = &number;

    ![image-20200908151415800](07.포인터와_동적_객체_생성.assets/image-20200908151415800.png)
    
- **간접 참조 연산자 ***

    - 포인터 변수에는 주소가 저장되어있음
    - 그 주소에 저장되어 있는 데이터를 얻을 때 사용

    ![image-20200908152517004](07.포인터와_동적_객체_생성.assets/image-20200908152517004.png)

    

      ```c++
    #include <iostream>
    using namespace std;
    int main() {
        int number = 0;
        double d = 20.2;
    
        int *p = &number;
        // p = &d;  // 에러
        double *pd = &d;
    
        cout << p << endl;
        cout << *p << endl;
    
        cout << sizeof(number) << "," << sizeof(d) << endl;
        cout << sizeof(p) << endl;  // int *
        cout << sizeof(pd) << endl;  // double *
    
        return 0;
    }
      ```

    **0x61fe0c**
    0
    4,8
    8
    8

    ---



- **NULL**

    - 포인터가 아무것도 가리키지 않는 것을 의미하는 특수한 데이터
        - 0으로 해석되므로 int이기도 하면서 포인터 이기도 함
    - 포인터 변수를 초기화할 때 사용
    - nullptr 사용 가능
        - 포인터로만 해석

    ```c++
    #include <iostream>
    using namespace std;
    
    void f(int i) {
        cout << "f(int)" << endl;
    }
    
    void f(char *p) {
        cout << "f(char *)" << endl;
    }
    
    int main() {
        int *pNumber = NULL;  // 권장
        int *pNumber2;  // 권장하지 않음, 임의의 초기값을 가짐
    
        if(pNumber != NULL) {  // 포인터 안정성 검사
            cout << *pNumber << endl;
    }
    
    if(pNumber2 != NULL) {  // 결과 장담 못함...
            cout << *pNumber2 << endl;
    }
    
    
        // f(NULL); -- int, char * 둘 다 가능하므로 에러
        f(nullptr);  // nullptr : 포인터 NULL의 의미하는 키워드
        return 0;
    }
    ```
    
    **17439201**
    f(char *)
    
    ---
    
    >   관례 : pointer 변수 --> **p**Number





## 동적 할당 메모리

-   **프로그램에서의 메모리**

    -   스택(Stack)

        -   지역 변수 할당 (정적할당)
        -   시스템에 의해 관리

    -   힙(Heap)

        -   동적 메모리 할당
        -   개발자에 의해 관리

        ![image-20200908162441461](07.포인터와_동적_객체_생성.assets/image-20200908162441461.png)



-   **new, delete**

    -   new

        -   동적으로 힙에 메모리를 할당

    -   delete

        -   동적으로 힙에 할당된 메모리를 회수
        -   파괴자가 호출됨
        -   동적 메모리를 회수 하지않으면 가비지(garbage) 증가 -- 메모리 누수

    -   ```c++
        class T {};
        T *p = new T;
        T *p = new T[N];
        T *p = new T[N] { initializer1, ... , initializeerN}; 
        ```

    -   ```c++
        int *p;
        p = new int[5]; 
        
        int *p = new int[5] {0, 1, 2, 3, 4};
        ```

        <img src="07.포인터와_동적_객체_생성.assets/image-20200908162713653.png" alt="image-20200908162713653" style="zoom:50%;" />

    -   ```c++
        int *p = new int;
        :
        delete p; // 단일 데이터 삭제
        
        
        int *p = new int[5] {0, 1, 2, 3, 4};
        delete [] p; // 배열 데이터 삭제
        ```

        

    new, delete

    ```c++
    #include <iostream>
    #include <time.h>
    using namespace std;
    
    int main() {
        int *ptr;
    
        srand(time(NULL));
        ptr = new int[10];
        for (int i = 0; i < 10; i++) {
            ptr[i] = rand();
        }
    
        for (int i = 0; i < 10; i++) {
            cout << ptr[i] << " ";
        }
        cout << endl;
        delete []ptr;
        return 0;
    }
    ```

    **10172 30097 1329 24679 4151 23900 15709 28541 10597 30398**

    ---


    가비지(garbage)

    ```c++
    #include <iostream>
    #include <time.h>
    using namespace std;
    
    int main() {
        int *ptr = new int;
        *ptr = 99;
        return 0;
    }
    ```